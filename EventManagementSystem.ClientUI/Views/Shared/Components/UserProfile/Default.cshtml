@using EventManagementSystem.BLL.ViewModels.Profile
@using EventManagementSystem.BLL.ViewModels.User
@model ProfileHeaderVM

<style>
    .profile-nav {
        --primary: #6366f1;
        --primary-hover: #4f46e5;
        --text: #1e293b;
        --text-light: #64748b;
        --border: #e2e8f0;
        --bg-hover: #f1f5f9;
        --transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .profile-container {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .profile-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid white;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: var(--transition);
    }

        .profile-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

    .profile-name {
        font-weight: 500;
        color: var(--text);
        transition: var(--transition);
        display: none;
    }

        .profile-name:hover {
            color: var(--primary);
        }

    .dropdown-toggle {
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        border-radius: 6px;
        transition: var(--transition);
    }

        .dropdown-toggle:hover {
            background: var(--bg-hover);
        }

    .dropdown-menu {
        border: none;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        padding: 8px 0;
        min-width: 200px;
        display: none;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .dropdown:hover .dropdown-menu {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .dropdown-item {
        padding: 8px 16px;
        color: var(--text);
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
    }

        .dropdown-item:hover {
            background: var(--bg-hover);
            color: var(--primary);
        }

    .dropdown-divider {
        margin: 4px 0;
        border-color: var(--border);
    }

    .dropdown-icon {
        width: 16px;
        color: var(--text-light);
    }

    .logout-btn {
        color: #ef4444;
    }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.05);
        }

    @@media (min-width: 768px) {
        .profile-name {
            display: block;
        }

        .profile-avatar {
            width: 40px;
            height: 40px;
        }
    }
</style>

<ul class="navbar-nav profile-nav">
    @if (Model.IsLoggedIn)
    {
        <li class="nav-item dropdown">
            <div class="dropdown">
                <div class="dropdown-toggle" id="profileDropdown">
                    <img src="@Model.ImageUrl"
                         alt="@Model.Fullname"
                         class="profile-avatar" />
                    <span class="profile-name">@Model.Fullname</span>
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="dropdown-menu" aria-labelledby="profileDropdown">
                    <a class="dropdown-item" asp-controller="Profiles" asp-action="Details" asp-route-id="@Model.Id">
                        <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        My Profile
                    </a>
                    <a class="dropdown-item" asp-controller="Profiles" asp-action="Edit" asp-route-id="@Model.Id">
                        <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        Settings
                    </a>
                    <div class="dropdown-divider"></div>
                    <form asp-controller="Auth" asp-action="SignOut" method="post">
                        <button type="submit" class="dropdown-item logout-btn w-100 text-start">
                            <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                            Sign Out
                        </button>
                    </form>
                </div>
            </div>
        </li>
    }
    else
    {
        <li class="nav-item">
            <div class="d-flex align-items-center">
                <a asp-controller="Auth" asp-action="SignIn" class="btn btn-outline-primary me-2">
                    Sign In
                </a>
                <a asp-controller="Auth" asp-action="SignUp" class="btn btn-primary">
                    Sign Up
                </a>
            </div>
        </li>
    }
</ul>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Handle dropdown hover behavior
        const dropdowns = document.querySelectorAll('.dropdown');

        dropdowns.forEach(dropdown => {
            const toggle = dropdown.querySelector('.dropdown-toggle');
            const menu = dropdown.querySelector('.dropdown-menu');

            // Show on hover
            dropdown.addEventListener('mouseenter', () => {
                menu.style.display = 'block';
                setTimeout(() => {
                    menu.style.opacity = '1';
                    menu.style.transform = 'translateY(0)';
                }, 10);
            });

            // Hide when mouse leaves
            dropdown.addEventListener('mouseleave', () => {
                menu.style.opacity = '0';
                menu.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    menu.style.display = 'none';
                }, 200);
            });
        });
    });
</script>